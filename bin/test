#!/bin/bash
set -e
cd `dirname $0`/..

rspec='./bin/rspec --color'

export RAILS_ENV='test'

if [ $# -gt 0 ]; then
  export RACK_TIMEOUT_SERVICE_TIMEOUT=0

  set -v

  eval "$rspec --format documentation $@"
else
  export COVERAGE=on
  export DISABLE_SPRING=true
  export RACK_TIMEOUT_SERVICE_TIMEOUT=1

  set -v

  eval "$rspec --order random --format progress --format RspecJunitFormatter --out tmp/test_results/rspec.xml"
  eval './bin/quality'
fi

# 'test complete'
