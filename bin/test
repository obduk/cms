#!/bin/bash
set -e

bundle=`dirname $0`/bundle

if [ $# -gt 0 ]; then
  set -v
  eval "xvfb-run --auto-servernum $bundle exec rspec $@"
else
  set -v
  eval "COVERAGE=on xvfb-run --auto-servernum $bundle exec rspec"
  eval "$bundle exec cane --no-doc"
  eval "$bundle exec rails_best_practices --silent"
  eval "$bundle exec brakeman --quiet --exit-on-warn"
  eval "$bundle exec travis-lint"
  echo "Build success"
fi

