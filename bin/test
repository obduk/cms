#!/bin/bash
set -e

cd `dirname $0`/..

if [ $# -gt 0 ]; then
  set -v
  eval "xvfb-run --auto-servernum ./bin/rspec $@"
else
  set -v
  eval "./bin/compile"
  eval "COVERAGE=on xvfb-run --auto-servernum ./bin/rspec"
  eval "./bin/rubocop --format simple"
  eval "./bin/cane --no-doc"
  eval "./bin/rails_best_practices --silent"
  eval "./bin/rake coffeelint"
  eval "./bin/brakeman --quiet --exit-on-warn"
  eval "./bin/travis-lint"
fi

echo "test complete"
